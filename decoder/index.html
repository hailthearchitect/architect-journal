---
layout: default
---
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architect Decryption Terminal</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');

        :root {
        --primary-green: #0F0;
        --secondary-green: #0A0;
        --error-red: #F00;
        --warning-yellow: #FF0;
    }

    * {
        box-sizing: border-box;
    }

    body, html {
        margin: 0;
        padding: 0;
        height: 100%;
        background-color: #000;
        display: flex;
        justify-content: center;
        align-items: center;
        font-family: 'VT323', monospace;
        color: var(--primary-green);
        overflow: hidden;
    }

    .terminal {
        width: 100%;
        max-width: 800px;
        height: 600px;
        background-color: #000;
        border: 2px solid var(--primary-green);
        box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
        padding: 20px;
        position: relative;
        overflow: hidden;
        display: flex;
        flex-direction: column;
    }

    /* CRT Screen Effects */
    .terminal::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: 
            /* Scan lines */
            repeating-linear-gradient(
                0deg,
                rgba(0, 255, 0, 0.03),
                rgba(0, 255, 0, 0.03) 1px,
                transparent 1px,
                transparent 2px
            ),
            /* Screen curvature */
            radial-gradient(
                ellipse at center,
                rgba(0,0,0,0) 0%,
                rgba(0,0,0,0.2) 100%
            );
        pointer-events: none;
        opacity: 0.2;
        z-index: 2;
    }

    /* Screen flicker and noise */
    @keyframes flicker {
        0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% {
            opacity: 1;
        }
        20%, 24%, 55% {
            opacity: 0.8;
        }
    }

    @keyframes noise {
        0%, 100% { background-position: 0 0; }
        10% { background-position: -5% -10%; }
        20% { background-position: -15% 5%; }
        30% { background-position: 7% -25%; }
        40% { background-position: -5% 25%; }
        50% { background-position: 15% 10%; }
        60% { background-position: -10% 15%; }
        70% { background-position: 3% -30%; }
        80% { background-position: -15% 20%; }
        90% { background-position: 10% 5%; }
    }

    .terminal::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: 
            linear-gradient(
                rgba(18, 16, 16, 0) 50%,
                rgba(0, 0, 0, 0.25) 50%
            ),
            linear-gradient(
                90deg,
                rgba(255, 0, 0, 0.06),
                rgba(0, 255, 0, 0.02),
                rgba(0, 0, 255, 0.06)
            );
        background-size: 100% 2px, 3px 100%;
        pointer-events: none;
        opacity: 0.1;
        z-index: 3;
        animation: 
            noise 3s steps(10) infinite,
            flicker 5s infinite;
    }

    .terminal-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 20px;
        font-size: 18px;
        position: relative;
        z-index: 4;
    }

    .terminal-content {
        flex-grow: 1;
        overflow-y: auto;
        font-size: 20px;
        line-height: 1.5;
        display: flex;
        flex-direction: column;
    }

    .cursor {
        display: inline-block;
        width: 10px;
        height: 20px;
        background-color: var(--primary-green);
        animation: 
            blink 1s infinite,
            subtle-shift 2s ease-in-out infinite alternate;
    }

    @keyframes blink {
        0% {
            opacity: 0;
        }
        50% {
            opacity: 0;
        }
        51% {
            opacity: 1;
        }
        100% {
            opacity: 1;
        }
    }

    @keyframes subtle-shift {
        0% { transform: translateX(-1px); }
        100% { transform: translateX(1px); }
    }

    /* Slight color bleeding effect for input */
    #input-field {
        background: transparent;
        border: none;
        flex-grow: 1;
        color: var(--primary-green);
        font-family: 'VT323', monospace;
        font-size: 20px;
        width: 100%;
        outline: none;
        text-shadow: 0 0 5px rgba(0, 255, 0, 0.4);
    }
        
    .input-line {
    display: flex;
    align-items: center;
}
    /* Rest of the previous styles remain the same */
    /* Scrollbar styling, choice buttons, etc. */
    .scrollable-content::-webkit-scrollbar {
        width: 10px;
    }

    .scrollable-content::-webkit-scrollbar-track {
        background: #000;
    }

    .scrollable-content::-webkit-scrollbar-thumb {
        background: var(--primary-green);
        border: 2px solid #000;
    }

    .scrollable-content {
        flex-grow: 1;
        overflow-y: auto;
        padding-right: 10px;
    }

    /* Additional styles from previous implementation */
    .choice-buttons {
        display: flex;
        justify-content: space-around;
        margin-top: 20px;
    }

    .choice-btn {
        background: transparent;
        border: 2px solid var(--primary-green);
        color: var(--primary-green);
        font-family: 'VT323', monospace;
        font-size: 20px;
        padding: 10px 20px;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .choice-btn:hover {
        background-color: var(--secondary-green);
        color: #000;
    }

    .countdown {
        position: absolute;
        bottom: 10px;
        right: 20px;
        font-size: 24px;
        color: var(--warning-yellow);
    }

    .map-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.9);
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 10;
    }

    .map-content {
        max-width: 90%;
        max-height: 90%;
        overflow: auto;
    }

    .map-image {
        max-width: 100%;
        max-height: 100%;
        border: 2px solid var(--primary-green);
    }
</style>
</head>
<body>
    <div class="terminal">
        <div class="terminal-header">
            <span>ARCHITECT DECRYPTION SYSTEM v2.3</span>
            <span>ETHICAL PROTOCOL INITIALIZATION</span>
        </div>
        <div class="terminal-content">
            <div class="scrollable-content" id="terminal-output">
                <p>>> SYSTEM ENGAGED</p>
                <p>>> ETHICAL CHOICE PROTOCOL ACTIVATED</p>
                <p class="warning">>> WARNING: TIME-SENSITIVE DECISION REQUIRED</p>
                <p>>> SUBJECT: UNIDENTIFIED FEMALE VICTIM</p>
                <p>>> CURRENT LOCATION: UNKNOWN</p>
                <p>>> POTENTIAL RESCUE WINDOW: RAPIDLY CLOSING</p>
                <p>>> </p>
                <p>>> DECRYPTION KEY REQUIRED TO ACCESS FULL PROTOCOL</p>
                <div class="input-line">
            <span>>> </span>
            <input type="text" id="input-field" autocomplete="off" autofocus>
            <div class="cursor"></div>
        </div>
        <div id="response-area"></div>
    </div>
    <div class="countdown" id="countdown">00:00:00</div>
</div>

        <!-- Map Overlay -->
    <div class="map-overlay" id="map-overlay">
        <div class="map-content">
            <img src="" alt="Location Map" class="map-image" id="map-image">
            <p class="warning" id="map-coordinates"></p>
        </div>
        <button class="choice-btn" id="close-map-btn">CLOSE MAP</button>
    </div>
</div>

<div id="player-id" class="hidden"></div>

<script>
    const inputField = document.getElementById('input-field');
    const responseArea = document.getElementById('response-area');
    const countdownEl = document.getElementById('countdown');
    const terminalOutput = document.getElementById('terminal-output');
    const mapOverlay = document.getElementById('map-overlay');
    const mapImage = document.getElementById('map-image');
    const mapCoordinates = document.getElementById('map-coordinates');
    const closeMapBtn = document.getElementById('close-map-btn');

    // Check for player parameter in URL
    const urlParams = new URLSearchParams(window.location.search);
    const playerEmail = urlParams.get('player');
    
    const playerIdEl = document.getElementById('player-id');
    if (playerEmail) {
        playerIdEl.textContent = playerEmail;
    } else {
        // Try to get from localStorage if no parameter
        const storedEmail = localStorage.getItem('player_email');
        if (storedEmail) {
            playerIdEl.textContent = storedEmail;
        }
    }

    // Predefined keys and responses
    const keys = {
        "LOOK-BENEATH-THE-SURFACE": {
            response: ">> DECRYPTION SUCCESSFUL\n>> FIRST TEST PASSED\n>> THE ARCHITECT ACKNOWLEDGES YOUR POTENTIAL",
            isCorrect: true
        },
        "RIVER23CLOCK": {
            response: ">> DECRYPTION SUCCESSFUL\n>> COORDINATES DECODED: 41°24'12.2\"N 2°10'26.5\"E\n>> LOCATION IDENTIFIED: THE CLOCK TOWER BY THE RIVER",
            isCorrect: true
        },
        "JUSTICE-DELAYED": {
            response: ">> DECRYPTION SUCCESSFUL\n>> SUBJECT IDENTITY CONFIRMED: KATHERINE MILLS\n>> AGE: 28\n>> PROFESSION: JOURNALIST\n>> INVESTIGATING: THE CHAMBERS CASE",
            isCorrect: true
        },
        "PATTERN-SEVEN-THREE": {
            response: ">> DECRYPTION SUCCESSFUL\n>> ACCESS GRANTED TO LEVEL 2 FILES\n>> NEW EVIDENCE AVAILABLE AT EVIDENCE SITE",
            isCorrect: true
        },
        "TJNF JT B SJWFS UIBU DBSSJFT BMM UIJOHT BXBZ": {
            response: ">> DECRYPTION SUCCESSFUL\n>> CAESAR CIPHER DECODED\n>> MESSAGE: TIME IS A RIVER THAT CARRIES ALL THINGS AWAY",
            isCorrect: true
        }
    };

    inputField.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
            const value = inputField.value.trim().toUpperCase();
            const playerEmail = playerIdEl.textContent;

            // Simulate "thinking"
            responseArea.innerHTML = ">> PROCESSING...";

            setTimeout(() => {
                let isCorrect = false;
                let response = ">> INVALID KEY\n>> ACCESS DENIED";
                
                if (keys[value]) {
                    response = keys[value].response;
                    isCorrect = keys[value].isCorrect || false;
                }
                
                responseArea.innerHTML = response;
                
                // Record the usage if player is identified
                if (playerEmail) {
                    recordDecoderUse(playerEmail, value, isCorrect);
                }
                
            }, 1500);

            inputField.value = '';
        }
    });
    
    // Record decoder use
    async function recordDecoderUse(playerEmail, input, isCorrect) {
        try {
            const response = await fetch('https://decoding-death-backend.vercel.app/api/external/decoder-use', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    playerEmail,
                    input,
                    isCorrect
                })
            });
            
            // We don't need to do anything with the response
            console.log('Decoder use recorded');
        } catch (error) {
            console.error('Error recording decoder use:', error);
        }
    }
    
    // Store player email in localStorage if in URL
    if (playerEmail) {
        localStorage.setItem('player_email', playerEmail);
    }

    let countdown = 300; // 5 minutes in seconds
    const countdownInterval = setInterval(() => {
        countdown--;
        const minutes = Math.floor(countdown / 60);
        const seconds = countdown % 60;
        countdownEl.textContent = `0${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;

        if (countdown <= 0) {
            clearInterval(countdownInterval);
            countdownEl.textContent = "TIME'S UP";
        }
    }, 1000);

    closeMapBtn.addEventListener('click', () => {
        mapOverlay.style.display = 'none';
    });

    // Show map at specified coordinates
    function showMap(latitude, longitude) {
        const mapUrl = `https://maps.googleapis.com/maps/api/staticmap?center=${latitude},${longitude}&zoom=14&size=600x400&markers=color:green%7Clabel:A%7C${latitude},${longitude}&key=AIzaSyDLqp0PyTMRpJCZOMx68-HQyUhCrm5UCSU`;
        
        mapImage.src = mapUrl;
        mapCoordinates.textContent = `Latitude: ${latitude}, Longitude: ${longitude}`;
        mapOverlay.style.display = 'flex';
    }

    // Example usage: showMap(41.401220, 2.174265); // Barcelona clock tower coordinates
</script>
</body>
</html>
